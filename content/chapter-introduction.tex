% !TEX root = ../my-thesis.tex
%
\chapter{Introducción}
\label{sec:intro}


%\cleanchapterquote{My own brain is to me the most unaccountable of machinery - always buzzing, humming, soaring roaring diving, and then buried in mud. And why? What's this passion for?}{Virgina Woolf}{(CEO Apple Inc.)}

\cleanchapterquote{My own brain is to me the most unaccountable of machinery - always buzzing, humming, soaring roaring diving, and then buried in mud. And why? What's this passion for?}{Virgina Woolf}

\section{Electroencefalografía: uso clínico y herramienta de investigación}

\section{Problema Directo del EEG}
\label{sec:methodology:direct}

Las señales electroenecefalográficas se ajustan al modelo electromagnético de las ecuaciones de Maxwell, aunque en su versión cuasi-estática
(debido a que son señales de muy baja frecuencia). Entonces, la generación de la señal de EEG puede ser replicada matemáticamente mediante la
solución del problema directo; el cual consiste en calcular el potencial eléctrico presente en el cuero cabelludo mediante el modelado de la transducción de la corriente eléctrica generada por una fuente posicionada en la corteza cerebral, en este caso siendo modelada como un dipolo eléctrico que representa la actividad neuronal en eventos de respuesta evocada (ER) \cite{Mosher1999, Hallez2007}. 

Dadas las condiciones cuasi-estáticas del EEG \cite{Plonsey1967} el cálculo del potencial generado por el dipolo de corriente con momento dipolar $ \mathbf{d} = \partial\emph{e}_{\mathbf{d}}$ con posición $\mathbf{r}_{q}$ en un medio conductor infinito con conductividad $\sigma$ se describe por:

\begin{equation}
	\label{fdip}
	V(\mathbf{r},\mathbf{r}_{dip},\mathbf{d})=\frac{\mathbf{d}\cdot(\mathbf{r}-\mathbf{r}_{q})}{4\pi \sigma {||\mathbf{r}-\mathbf{r}_{q}||}^{3}}\text{,}
\end{equation}

con $\mathbf{r}$ siendo la posición donde el potencial es calculado \cite{Hallez2007}.

El método de elementos de frontera (BEM por sus siglas en inglés \emph{Boundary-element-method}) puede ser utilizado para la solución del problema directo sobre un modelo geométricamente realista \cite{Ermer2001}. Este método es capaz de obtener el campo eléctrico sobre un volumen problema calculando el potencial inducido por una fuente de corriente en las interfaces y frontera del volumen \cite{Hallez2007}. Nuestro modelo geométricamente realista es el volumen problema y las mallas que lo componen son las interfaces que tienen diferentes valores de conductividad dependiendo del tejido representado, las pequeñas áreas triangulares de las mallas son los elementos de frontera en los que se calculará el potencial inducido por el dipolo eléctrico.

El modelo matemático que describe el potencial $V(\mathbf{r})$ de cualquier punto $\mathbf{r}$ en un volumen conductor dividido por elementos de frontera es:

\begin{equation}
	\label{bem}
	V(r) = \frac{2\sigma_{0}}{\sigma_{k}^{-} + {\sigma_{k}^{+}}} V_{0}(r) + \frac{1}{2\pi} \sum_{j=1}^{R}\frac{\sigma_{j}^{-}-\sigma_{j}^{+}}{\sigma_{k}^{-}+\sigma_{k}^{+}} \int_{r'\varepsilon S_{j}} V(r') \frac{r'-r}{||r'-r||^3}\partial S_{j}\text{,}
\end{equation}

donde $\sigma_{0}$ corresponde al medio en el que el dipolo fuente está localizado (la malla de la corteza cerebral) y $V_{0}(\mathbf{r})$ es el potencial en $\mathbf{r}$ para un medio infinito con conductividad $\sigma_{0}$ como en la \cref{fdip}. $\sigma_{j}^{-}$ y $\sigma_{j}^{+}$ son las conductividades de los compartimentos interno y externo divididos por la interfaz $S_{j}$. $\partial S$ es un vector orientado ortogonalmente a un elemento de superficie y $||\partial S||$ el área de ese elemento de superficie \cite{Hallez2007}. 

Considerando que la solución se busca en un volumen conductor de múltiples interfaces $S_{j}$ con N número de triángulos, el potencial es calculado en el centro de cada uno de estos con la \cref{bem}. Por esta razón la integral sobre la interfaz $S_{j}$ se reescribe como una sumatoria de integrales sobre esta superficie:

\begin{equation}
	\label{bem2}
	V(r) = \frac{2\sigma_{0}}{\sigma_{r}^{-} + {\sigma_{r}^{+}}} V_{0}(r) + \frac{1}{2\pi} \sum_{k=1}^{R}\frac{\sigma_{k}^{-}-\sigma_{k}^{+}}{\sigma_{r}^{-}-\sigma_{r}^{+}} \sum_{j=1}^{N_{S_{k}}} \int_{\Delta_{S_{k,j}}} V(r') \frac{r'-r}{||r'-r||^3}\partial S_{k}\text{,}
\end{equation}

cuya integral se calcula sobre $\Delta_{S_{j},k}$, el j-ésimo triángulo en la superficie $S_{j}$, y $R$ es el número de interfaces en el volumen \cite{Hallez2007}. 

Tanto en \cref{bem} como en \cref{bem2} se observa el rol que la razón entre las conductividades de los compartimentos internos y externos juega en el cálculo del potencial en el volumen conductor, ya que de esta depende el potencial inducido en cada uno de los elementos de frontera y por ende el proyectado sobre la capa más externa del modelo; el cuero cabelludo.

Estas ecuaciones pueden ser transformadas en un set de ecuaciones lineares:

\begin{equation}
	\label{lineal}
	V = BV + V_{0},
\end{equation}

Donde $V$ y $V_{0}$ son vectores que denotan el potencial buscado en cada nodo y el potencial en un medio infinito respectivamente. $B$ corresponde a la matriz generada por las integrales, la cual depende de la geometría de las superficies y la conductividad asignada a cada una de estas \cite{Hallez2007}.

\section{Problema Inverso del EEG}
\label{sec:intro:inverse}

Como su nombre lo indica; la contraparte del problema directo del EEG es el problema inverso. Si el problema directo se enfoca en obtener una solución para el campo eléctrico generado sobre un volumen conductor a partir de una fuente de corriente, el problema inverso consiste en identificar la posición de dichas fuentes de actividad eléctrica al modelar la amplitud de los dipolos eléctricos y seleccionando los que tengan una mayor actividad \cite{Baillet2001}. Para su cálculo es necesario: las mediciones de EEG que en nuestro caso son las obtenidas mediante el problema directo, el volumen conductor, y la matriz de ganancia con su correspondiente plantilla del sistema de EEG.

Existen muchas maneras de resolver el problema inverso neuroeléctrico. En años recientes, los métodos de filtrado espacial basados en la conformación de haces (\emph{beamforming}) han ganado popularidad. En particular, el conformador de haces de restricciones lineales y mínima varianza (LCMV del inglés \emph{linearly-constrained minimum variance beamfomer}) originalmente diseñado e introducido en las neurociencias por Van Veen y Van Drongele \cite{VanVeen1988, VanVeen1997}. La aplicación de este filtro espacial en la solución del problema inverso; relaciona el campo electromagnético medido en el exterior y superficie de la cabeza con la actividad neuronal subyacente, utilizando la covarianza de las señales medidas y los modelos de actividad de las fuentes y transferencia de señal entre estas y los sensores, que en nuestro caso, estos modelos corresponden a la matriz de ganancia generada con BEM. Los coeficientes de ponderación o pesos del filtro espacial se calculan para cada ubicación en la región de interés (ROI) y acorde a Van Veen y Jaiswal \cite{VanVeen1997,Jaiswal2020} su formulación es la siguiente:

Sea $x$ una señal vector de forma $M \times 1$ de datos MEG o EEG medidos con $M$ sensores, y $N$ es el número de puntos en la ROI con coordenadas $r_j$, ($j = 1, ..., N$). Entonces la fuente $y(r_j)$ en cualquier punto $r_j$ puede ser estimada como la combinación ponderada de la medición $x$ con una matriz de $M \times 3$ denominada $W(r_j)$, de forma que

\begin{equation}
y(r_j) = W^{T}(r_j)x
\end{equation}

en esta ecuación $W(r_j)$ se conoce como el filtro espacial para una fuente en la posición $r_j$. Este tipo de filtro espacial produce un beamformer o formador de haces de tipo vectorial al estimar por separado la actividad para tres orientaciones de fuente ortogonales, correspondientes a las tres columnas de la matriz. Siguiendo el desarrollo de Van Veen y Jaiswal \cite{VanVeen1997,Jaiswal2020}, el filtro espacial $W(r_j)$ para el beamformer vectorial se define como

\begin{equation}
W^{T}(r_j) = (L^{T}(r_j)C^{-1}L(r_j))^{-1}L^{T}(r_j)C^{-1}
\end{equation}

Aquí $L(r_j)$ es la matriz de ganancia con forma $M \times 3$ que define la contribución de una fuente dipolar en la posición $r_j$ a la medición $x$, y $C$ es la matriz de covarianza calculada a partir de las mediciones de EEG o MEG. Para realizar la localización de las fuentes utilizando LCMV, se estima la varianza resultante $Var(y(r_j))$ en cada punto del espacio de la fuente \cite{VanVeen1997,Jaiswal2020}, en nuestro caso siendo la malla de la corteza cerebral, lo que resulta en

\begin{equation}
\widehat{\text{Var}}(y(r_j)) = \text{Traza}[L^{T}(r_j)C^{-1}L(r_j)]^{-1}.
\end{equation}

Por lo general, la señal medida está contaminada por ruido no uniformemente distribuido y por lo tanto, la varianza de la señal estimada se normaliza con la varianza del ruido proyectado $C_n$ calculada sobre parte de las mediciones en estado basal o en reposo (\emph{baseline noise}). Esta estimación normalizada es denomida índice de actividad neural (NAI del inglés \emph{neuronal activity index}) \cite{VanVeen1997} y puede expresarse como

\begin{equation}
\text{NAI}(r_j) = \frac{\text{Traza}\left\{[L^{T}(r_j)C^{-1}L(r_j)]^{-1}\right\}}{\text{Traza}\left\{[L^{T}(r_j)C_n^{-1}L(r_j)]^{-1}\right\}}
\end{equation}

Al escanear y procesar todos los puntos en la región de interés en el espacio de la fuente, las mediciones de EEG y MEG se transforman en un mapa del NAI que puede ser proyectado sobre la misma malla de la corteza cerebral del modelo geométricamente realista, efectivamente resolviendo el problema inverso. Cabe mencionar que esta formulación es solo para un instante en el tiempo, lo que resulta en un snapshot de la actividad en ese momento de las mediciones de EEG/MEG, si se quiere observar el cambio de la actividad con respecto al tiempo, se tiene que calcular el kernel para el intervalo de interés.

\section{La razón de conductividad cerebro/cráneo como objeto de estudio}
\label{sec:intro:study}

La idea de estimar la razón de la conductividad cerebro/cráneo nace del uso del EEG como herramienta de localización de fuentes de actividad neuronal, las cuales son posibles de estimar con las mediciones del potencial eléctrico sobre el cuero cabelludo obtenidas de EEG en cada uno de sus electrodos, y subsecuentemente aplicando técnicas de procesamiento digital de señales en tales mediciones. La problemática de este acercamiento es que es necesario contar con un modelo \emph{a priori} de las posibles fuentes de actividad neuronal con la finalidad de tener puntos de referencia para la proyección de las mediciones de EEG y su ajuste al modelo. Este acercamiento a la estimación de fuentes de actividad neuronal se define como el problema directo (solución de un modelo de fuentes de actividad neuronal) y el problema inverso (solución para la localización de fuentes de actividad neuronal) del EEG \cite{Grech2008}. Dado que una parte del problema no puede ser resuelta sin tomar suposiciones de la solución de la otra y de los parámetros bioelectromagnéticos de los tejidos que componen la cabeza como las conductividades, este acercamiento se considera un problema abierto, en particular el problema inverso del EEG por la multitud de posibles voltajes resultantes y su inestabilidad derivada de la sensibilidad a pequeños cambios en los datos como el ruido generado por el equipo de EEG. 

Cuando este procedimiento es implementado para la localización de fuentes de actividad neuronal, estas son las que se toman como variable independiente con la intención de encontrar la posición que mejor se ajusta a las mediciones, mientras que como se comentó anteriormente, las propiedades bioelectromagnéticas en particular la conductividad de los tejidos, se asumen como conocidas utilizando valores estándar (\emph{i.e.} $0.33\text{ S/m}$ para el cerebro y $0.0042 \text{ S/m}$ para el cráneo). Estos valores aunque son utilizados ampliamente en el área de las neurociencias \cite{Rush1968,Rush1969,Cohen1983}, han sido debatidos por múltiples estudios con acercamientos novedosos de la estimación de las conductividades obteniendo valores significativamente diferentes al estándar \cite{McCann2019}, hablando en términos de la razón de la conductividad cerebro/cráneo (BSCR \emph{Brain-scalp-conductivity-ratio}) esta es una diferencia hasta 4 veces mayor (1:80 vs 1:20). Dada la multitud de diferentes soluciones a una misma implementación del problema inverso del EEG, se puede considerar que el uso de diferentes valores de conductividad también pueden afectar al resultado y puede ser utilizado como una variable en el cálculo del problema inverso en donde el caso de estudio es la estimación de la razón de la conductividad misma, claro, teniendo en cuenta que no podemos tener dos variables independientes, tendríamos que mantener en este caso la posición de las fuentes de actividad neuronal como conocidas para la solución del problema inverso. 


%El cerebro es un órgano de suma importancia, ya que es el responsable de la coordinación del sistema nervioso central en vertebrados y la mayoría de invertebrados. En el caso de los seres humanos el cerebro se divide, \emph{grosso modo}, en telencéfalo, cerebelo, y tronco del encéfalo, cada una de estas zonas llevan a cabo distintas funciones fisiológicas; además el cerebro se encuentra resguardado por el cráneo teniendo el fluido cerebroespinal (CSF) de por medio, este último sirve como protección contra trauma e infecciones CITA. Dado nuestro objeto de estudio, el telencéfalo es de particular interés porque la parte externa de este es la corteza cerebral, la cual toma parte en las funciones de percepción, atención, consciencia, pensamiento, lenguaje, y cognición.
%
%Las funciones fisiológicas de la corteza cerebral se dan gracias a la composición de su tejido, el cual tiene a la neurona por unidad básica FIGURA NEURONA. MENCIONAR GLIALES? Toda actividad que se produce en la corteza cerebral se origina en las neuronas en forma señales eléctricas. Al presentarse algún estímulo asociado con las funciones de la corteza cúmulos de neuronas producen potenciales eléctricos en el mismo intervalo, generando así un campo eléctrico que se propaga por la corteza, CSF, cráneo y cuero cabelludo, el cual puede ser observado y medido con un electroencefalograma (EEG). MEG MENCIONAR?
%
%Este fenómeno electromagnético se origina gracias a que existe una diferente concentración de iones dentro y fuera de la membrana plasmática de las neuronas. Dicha diferencia de carga eléctrica dentro y fuera de la membrana  produce una diferencia de potencial sobre la misma, 
% 
%
%
%
%
%El potencial eléctrico que se observa en las neuronas es producido mediante el flujo de iones a través de proteínas embebidas en la membrana plasmática que funcionan como canales. 


 
